<script language="javascript" type="text/javascript">
{include file="form_js.html"}
</script>

<div class="divtable shade1">
<form name="profile" action="{url _base=$PHP_SELF c=$c act=$act id=$id}" method="POST">
<input name="ref" value="{$ref|escape}" type="hidden" />
	<div class="table-hdr">
		<h3><#Edit Log Source#></h3>
		<p>{$safelogsource}</p>
	</div>

{if $stateid}
	<div class="row{if $form.updatestate.error} row-err{/if}">
		<span onmouseover="statusText('{$form.updatestate.statustext|escape:'quotes'}')" onmouseout="notext()" class="label">{$form.updatestate.label}</span>
		<span class="input">
			<input name="updatestate" type="checkbox" value="1"{if $updatestate} checked{/if} />
			<p>
				<!--#LOGSOURCE_STATE_BLURB#-->
				When changing an existing logsource that has been processed in the past you will usually 
				want to have the state information updated to match the new logsource. Otherwise the 
				modified logsource will appear to be a new and different source and will cause previous 
				logs to be read a 2nd time.
			</p>
			{if $form.updatestate.error}<p class="err">{$form.updatestate.error}</p>{/if}
		</span>
	</div>
{/if}

	<div class="row-spacer"></div>
	<div class="row{if $form.path.error} row-err{/if}">
		<span onmouseover="statusText('{$form.path.statustext|escape:'quotes'}')" onmouseout="notext()" class="label">{$form.path.label}</span>
		<span class="input"><input name="path" value="{$path|escape}" type="text" size="40" class="field" />{if $form.path.error}<p class="err">{$form.path.error}</p>{/if}</span>
	</div>
	<div class="row-spacer"></div>
	<div class="row{if $form.protocol.error} row-err{/if}">
		<span onmouseover="statusText('{$form.protocol.statustext|escape:'quotes'}')" onmouseout="notext()" class="label">{$form.protocol.label}</span>
		<span class="input">
			<select name='protocol' class='field' onchange="web.getObj('form_remote').style.display = this.options[this.selectedIndex].value == 'file' ? 'none' : 'block'; ">
{foreach from=$validprotocols item='label' key='proto'}
				<option value='{$proto}'{if $proto == $protocol} selected{/if}>{$label}</option>
{/foreach}
			</select>
			<p>
				<!--#LOGSOURCE_PROTOCOL_BLURB#-->
				If the logs are on a remote server specify the protocol 
				you want to use to download the logs for processing.
			</p>
			{if $form.protocol.error}<p class="err">{$form.protocol.error}</p>{/if}
		</span>
	</div>

<div id="form_remote"{if $protocol == 'file' and !count($errors)} style="display: none"{/if}>

	<div class="row{if $form.host.error} row-err{/if}">
		<span onmouseover="statusText('{$form.host.statustext|escape:'quotes'}')" onmouseout="notext()" class="label">{$form.host.label}</span>
		<span class="input"><input name="host" value="{$host|escape}" type="text" size="40" class="field" />{if $form.host.error}<p class="err">{$form.host.error}</p>{/if}</span>
	</div>
	<div class="row{if $form.port.error} row-err{/if}">
		<span onmouseover="statusText('{$form.port.statustext|escape:'quotes'}')" onmouseout="notext()" class="label">{$form.port.label}</span>
		<span class="input"><input name="port" value="{$port|escape}" type="text" size="5" class="field" />{if $form.port.error}<p class="err">{$form.port.error}</p>{/if}</span>
	</div>
	<div class="row{if $form.username.error} row-err{/if}">
		<span onmouseover="statusText('{$form.username.statustext|escape:'quotes'}')" onmouseout="notext()" class="label">{$form.username.label}</span>
		<span class="input"><input name="username" value="{$username|escape}" type="text" size="40" class="field" />{if $form.username.error}<p class="err">{$form.username.error}</p>{/if}</span>
	</div>
	<div class="row{if $form.blankpassword.error} row-err{/if}">
		<span onmouseover="statusText('{$form.blankpassword.statustext|escape:'quotes'}')" onmouseout="notext()" class="label">{$form.blankpassword.label}</span>
		<span class="input">
			<input name="blankpassword" type="checkbox" value="1" onclick="web.getObj('form_pw').style.display = this.checked ? 'none' : 'block'" {if $blankpassword} checked{/if} />
{*
			<input name="blankpassword" type="radio" value="1" onclick="web.getObj('form_pw').style.display = this.checked ? 'none' : 'block'" {if $blankpassword} checked{/if} /><#Yes#>
			<input name="blankpassword" type="radio" value="0" onclick="web.getObj('form_pw').style.display = this.checked ? 'block' : 'none'" {if !$blankpassword} checked{/if} /><#No#>
*}
			{if $form.blankpassword.error}<p class="err">{$form.blankpassword.error}</p>{/if}
		</span>
	</div>
<div id="form_pw"{if $blankpassword} style="display: none"{/if}>
{if $id}
	<div class="row"><span class="input"><p><#Only enter a password if you want to change it#></p></span></div>
{/if}
	<div class="row{if $form.password.error} row-err{/if}">
		<span onmouseover="statusText('{$form.password.statustext|escape:'quotes'}')" onmouseout="notext()" class="label">{$form.password.label}</span>
		<span class="input"><input name="password" type="password" size="40" class="field" />{if $form.password.error}<p class="err">{$form.password.error}</p>{/if}</span>
	</div>
	<div class="row{if $form.password2.error} row-err{/if}">
		<span onmouseover="statusText('{$form.password2.statustext|escape:'quotes'}')" onmouseout="notext()" class="label">{$form.password2.label}</span>
		<span class="input"><input name="password2" type="password" size="40" class="field" />{if $form.password2.error}<p class="err">{$form.password2.error}</p>{/if}</span>
	</div>
</div>
</div>

	<div class="row-spacer"></div>
	<div class="row">
		<div class="form-actions">
			<input name="submit" value="<#Save Configuration#>" type="submit" class="btn" />
			<input name="cancel" value="<#Cancel#>" type="submit" class="btn" />
		</div>
	</div>
	{include file='block_form_footer.html'}
</form>
<div class="spacer"></div>
</div>

