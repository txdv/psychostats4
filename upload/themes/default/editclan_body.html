<script language="javascript" type="text/javascript">
{include file="form_js.html"}
var maxchars = {$themeconf.format.max_logo_size};
{literal}
function previewIcons() {
	w = window.open("icongallery.php", "iconPreview", "width=400,height=250,resizable=yes,menubar=no");
	w.focus();
}

function previewLogo() {
	text = document.forms.profile.elements.logo.value;
	if (text == '') return;
	w = window.open("", "logoPreview", "width=250,height=250,resizable=yes,menubar=no");
	with (w.document) {
		write('<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">');
{/literal}
		write('<html><head><title>Logo Preiew</title><link href="{$themeurl}styles.css" rel="stylesheet" type="text/css"></head><body><div align="center">');
{literal}
		write(text);
		write('</div></body></html>');
		close();
	}
	w.focus();
}
function ta_update(text) {
	l = web.getObj('logo');
	if (!l) return;
	if (l.value.length > maxchars) {
		l.value = l.value.substr(0,maxchars);
	}
	s = l.value.length +  "/" + maxchars + " <#chars#>";
	web.write(s,text);
}
{/literal}
</script>
<div class="divtable shade1">
<form name="profile" action="{url id=$id}" method="POST">
<input name="ref" value="{$ref|escape}" type="hidden" />
	<div class="table-hdr">
		<h3><#Edit Clan Profile#></h3>
		<p><#Profile for clantag#>: <b>{$profile.clantag|escape}</b>
		{if $profile.name}<br><#Clan Name#>: <b>{$profile.name|escape}</b>{/if}</p>
	</div>
	<div class="row-spacer"></div>

	<div class="row{if $form.clanname.error} row-err{/if}">
		<span onmouseover="statusText('{$form.clanname.statustext|escape:'quotes'}')" onmouseout="notext()" class="label">{$form.clanname.label}</span>
		<span class="input"><input name="clanname" value="{$clanname|escape}" type="text" size="40" class="field" />
			<input id="locked" name="locked" value="1" type="checkbox" {if $locked} checked{/if} /><label for="locked" onmouseover="statusText('{$form.locked.statustext|escape:'quotes'}')" onmouseout="notext()">{$form.locked.label}</label>
			{if $form.clanname.error}<p class="err">{$form.clanname.error}</p>{/if}</span>
	</div>
	<div class="row{if $form.icon.error} row-err{/if}">
		<span onmouseover="statusText('{$form.icon.statustext|escape:'quotes'}')" onmouseout="notext()" class="label">{$form.icon.label}</span>
		<span class="input">
			<select name="icon" size="1" class="field" onchange="web.getObj('iconimg').src = (options[selectedIndex].value) ? '{$themeconf.rootimagesurl}icons/' + options[selectedIndex].value : '{$spacerimg}'">
				<option value=""><#No Icon#></option>
{*  The background image only works on Mozilla (Firefox), IE and Opera silently ignore the style *}
{foreach name="icons" from=$icons item="i"}
{*				<option style="background: url({$themeconf.rootimagesurl}icons/{$i.filename}) no-repeat; padding-left: 20px; height: 16px;" value="{$i.filename}"{if $i.filename == $icon} selected{/if}>{$i.filename}</option> *}
				<option value="{$i.filename}"{if $i.filename == $icon} selected{/if}>{$i.filename}</option>
{/foreach}
			</select>
			<img id="iconimg" src="{if $icon}{$themeconf.rootimagesurl}icons/{$icon}{else}{$spacerimg}{/if}" width="15" height="15" style="border: 1px solid black; vertical-align: top" />
			<p style="display: inline">
				<a href="javascript:previewIcons()"><#View Gallery#></a>
{if $allow_icon_upload}
				 / <a href="{url _base='uploadicon.php' ref=$REQUEST_URI}"><#Upload Icon#></a>
{/if}
			</p>
			{if $form.icon.error}<p class="err">{$form.icon.error}</p>{/if}</span>
	</div>
	<div class="row{if $form.email.error} row-err{/if}">
		<span onmouseover="statusText('{$form.email.statustext|escape:'quotes'}')" onmouseout="notext()" class="label">{$form.email.label}</span>
		<span class="input"><input name="email" value="{$email|escape}" type="text" size="40" class="field" />{if $form.email.error}<p class="err">{$form.email.error}</p>{/if}</span>
	</div>
	<div class="row{if $form.aim.error} row-err{/if}">
		<span onmouseover="statusText('{$form.aim.statustext|escape:'quotes'}')" onmouseout="notext()" class="label">{$form.aim.label}</span>
		<span class="input"><input name="aim" value="{$aim|escape}" type="text" size="40" class="field" />{if $form.aim.error}<p class="err">{$form.aim.error}</p>{/if}</span>
	</div>
	<div class="row{if $form.icq.error} row-err{/if}">
		<span onmouseover="statusText('{$form.icq.statustext|escape:'quotes'}')" onmouseout="notext()" class="label">{$form.icq.label}</span>
		<span class="input"><input name="icq" value="{$icq|escape}" type="text" size="40" class="field" />{if $form.icq.error}<p class="err">{$form.icq.error}</p>{/if}</span>
	</div>
	<div class="row{if $form.msn.error} row-err{/if}">
		<span onmouseover="statusText('{$form.msn.statustext|escape:'quotes'}')" onmouseout="notext()" class="label">{$form.msn.label}</span>
		<span class="input"><input name="msn" value="{$msn|escape}" type="text" size="40" class="field" />{if $form.msn.error}<p class="err">{$form.msn.error}</p>{/if}</span>
	</div>
	<div class="row{if $form.website.error} row-err{/if}">
		<span onmouseover="statusText('{$form.website.statustext|escape:'quotes'}')" onmouseout="notext()" class="label">{$form.website.label}</span>
		<span class="input"><input name="website" value="{$website|escape}" type="text" size="40" class="field" />{if $form.website.error}<p class="err">{$form.website.error}</p>{/if}</span>
	</div>
	<div class="row{if $form.logo.error} row-err{/if}">
		<span onmouseover="statusText('{$form.logo.statustext|escape:'quotes'}')" onmouseout="notext()" class="label">{$form.logo.label}<p>
			<span id="logochars"></span>
			<br><br><a href="javascript:previewLogo()" title="<#Opens in a new window#>"><#Preview Logo#></a></p>
		</span>
		<span class="input"><textarea id="logo" onkeyup="ta_update('logochars')" name="logo" rows="4" cols="40" wrap="soft" class="field" style="width: 95%">{$logo|escape}</textarea>{if $form.logo.error}<p class="err">{$form.logo.error}</p>{/if}
			<p><!--#LOGO_BLURB#-->The logo field is treated as normal HTML. For instance, If you want to create an image you need to input the proper &lt;img&gt; tag, etc. 
		</span>
	</div>
	<div class="row-spacer"></div>
	<div class="row">
		<div class="form-actions">
			<input name="submit" value="<#Save Profile#>" type="submit" class="btn" />
			<input name="cancel" value="<#Cancel#>" type="submit" class="btn" />
		</div>
	</div>
	{include file='block_form_footer.html'}
</form>
<div class="spacer"></div>
</div>

<br>
<a name="members"></a>
<div class="divtable shade1">
<form name="members" action="{url id=$id _anchor='members'}" method="POST">
<input name="ref" value="{$ref|escape}" type="hidden" />
	<div class="table-hdr">
		<h3><#Add or Remove Clan Members#></h3>
	</div>
	<div class="row-spacer"></div>

{if $msg}
	<center><div id="msg-success" class="row row-err-success">{$msg|escape}</div></center>
	<div class="row-spacer"></div>
{/if}

	<div class="row">
		<span onmouseover="statusText('<#Add a member to this clan roster#>', 'statustext2')" onmouseout="notext()" class="label"><#Add Member#>:</span>
		<span class="input">
			<input name="search" value="{$search|escape}" type="text" size="40" class="field" />
			<input name="dosearch" value="<#Search#>" type="submit" class="btn" />
		</span>
	</div>

{if $searchresults}
	<div class="row">
		<span onmouseover="statusText('<#Select matching member to add to roster#>', 'statustext2')" onmouseout="notext()" class="label"><#Search Results#>:<br><span class="text-small">
			(Top {$searchresults|@count} matches)
			<br><#Double click name to view#>
		</span></span>
		<span class="input">
			<select name="plrids[]" multiple="multiple" size="5" class="field" ondblclick="window.open('{url _base='player.php' a=1}&amp;id=' + this.options[this.selectedIndex].value, '_blank')">
	{foreach from=$searchresults item="p"}
				<option value="{$p.plrid}">{$p.name|escape}</option>
	{/foreach}
			</select>
			<br><input name="add" value="<#Add Selected Members#>" type="submit" class="btn" />
		</span>
	</div>
{elseif $nosearchresults}
	<div class="row">
		<span class="input">{$nosearchresults|escape}</span>
	</div>
{/if}

	<div class="row-spacer"></div>
	<div class="row">
		<span onmouseover="statusText('<#Players currently in this clan roster#>','statustext2')" onmouseout="notext()" class="label">
			{$clanmembers|@count} <#Members#>:
			<br><span class="text-small"><#Double click name to view#></span>
		</span>
		<span class="input">
			<#Control-Click to select more than one member#><br>
			<select name="members[]" multiple="multiple" size="10" class="field" ondblclick="window.open('{url _base='player.php' a=1}&amp;id=' + this.options[this.selectedIndex].value, '_blank')">
{foreach from=$clanmembers item="p"}
				<option value="{$p.plrid}">{$p.name|escape}</option>
{/foreach}
			</select>
			<br><input name="del" value="<#Delete Selected Members#>" type="submit" class="btn" />
		</span>
	</div>

	<div class="row-spacer"></div>
	<div class="row">
		<div class="form-actions">
			<div style="float: left">
			</div>
			<div style="float: right">
				<input name="cancel" value="<#Done#>" type="submit" class="btn" />
			</div>
		</div>
	</div>
	{include file='block_form_footer.html' statustext='statustext2'}
</form>
<div class="spacer"></div>
</div>

<script text="text/javascript">
	ta_update('logochars');
</script>
